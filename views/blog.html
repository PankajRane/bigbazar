<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>Big Bazaar</title>

  <!-- Bootstrap -->
  <link href="../stylesheet/bootstrap.min.css" rel="stylesheet">

  <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,700,100' rel='stylesheet' type='text/css'>

  <link href="../stylesheet/main.css" rel="stylesheet">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <link rel="shortcut icon" href="../images/favicon.ico" />
  <style>
    .ontop {
      z-index: 0;
      width: 20%;
      height: 100%;
      top: 0;
      left: 0;
      display: none;
      position: absolute;
      background-color: #cccccc;
      color: #aaaaaa;
      opacity: .4;
      filter: alpha(opacity=50);
    }
    
    #popup {
      width: 300px;
      height: 200px;
      position: absolute;
      color: #000000;
      background-color: #ffffff;
      /* To align popup window at the center of screen*/
      top: 50%;
      left: 50%;
      margin-top: -100px;
      margin-left: -150px;
    }
  </style>
  <script type="text/javascript">
      function pop(div) {
        document.getElementById(div).style.display = 'block';
      }
      function hide(div) {
        document.getElementById(div).style.display = 'none';
      }
      //To detect escape button
      document.onkeydown = function(evt) {
        evt = evt || window.event;
        if (evt.keyCode == 27) {
          hide('popDiv');
        }
      };
    </script>
</head>

<body>

  <div class="full-width-bg submit-blog">


    <div class="row" style="margin-top:30px">

      <div class="col-sm-6 text-center">

        <div class="row">
          <div class="col-sm-12 text-center">
            <a href="#" target="_blank">
              <img src="../images/logo.png" class="logo" style="width: 430px;float: left;">
            </a>
          </div>
        </div>


      </div>

      <div class="col-sm-6" style="padding:30px;">
        <div class="row">
        <div class="col-sm-12" style="padding:5px 80px;">
         
          
 <button onclick="logout()" type="button" class="btn btn-default">
                <i class="fa fa-lock sub-fa"></i>SIGN OUT</button>
                <button type="button" onclick="window.location = '/users/profile'" class="btn btn-default">
              <i class="fa fa-cog sub-fa"></i>SETTINGS</button>

        </div> 
        </div>
        <div class="row" style="margin-top: 4px;">
           <div class="col-sm-12">
         
            <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/E9am3ySQoJ0" style="border:0px;width:90%; height:400px;"></iframe>
         <form style=" float:left;">
          <!-- <div class="form-group"> -->
          <!--<label for="exampleInputEmail1">Enter URL:</label>-->
          <!-- <input type="text" name="blog_url" class="" id="blog_url" placeholder="" style="" > -->
          <!-- </div> -->

          <% if (locals.messages.info) { %>
            <input type="text" name="blog_url" class="" id="blog_url" placeholder="ENTER URL" style="" disabled>
            <button type="button" onclick="submitBlog()" name="submit" class="blog_submit" disabled>Blog already Submitted</button>
            <% } else { %>
              <input type="text" name="blog_url" class="" id="blog_url" placeholder="ENTER URL" style="">
              <button type="button" onclick="submitBlog()" name="submit" class="blog_submit">Submit</button>
              <% } %>



        </form>
        </div>
        </div>
        
      </div>

    </div>
  </div>


  <!--
          <div id="popDiv" class="ontop">
      
            Click Close OR escape button to close it
            <a href="#" onClick="hide('popDiv')">Close</a>
          
          </div>

          <div id="popDiverror" class="ontop">
      
            Click Error Close OR escape button to close it
            <a href="#" onClick="hide('popDiverror')">Close</a>
          
          </div>-->
  </div>


  <!-- Modal -->
  <div class="modal fade success" id="myModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <span class="success_icon"><i class="fa fa-check-circle"></i></span>
        </div>
        <div class="modal-body">
          <p>Thanks for your Submission</p>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal -->
  <div class="modal fade error" id="errorModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <span class="error_icon"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="modal-body">
          <p>Blog was already uploaded.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade wraning" id="wraningModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <span class="wraning_icon"><i class="fa fa-exclamation-triangle"></i></span>
        </div>
        <div class="modal-body">
          <p>Technical Error Please try after some time.</p>
        </div>
      </div>
    </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="../js/bootstrap.min.js"></script>
  <script type="text/javascript">
      function logout(){
         $.get( "/users/logout", { })
                  .done(function( data ) {
                    window.location = "/users/login"
                  });
      }

      function submitBlog(){
        var urlVal = document.getElementById("blog_url").value;
        if(validateURL(urlVal)){
            console.log('urlVal:--- ',urlVal);
            
            $.post( "/users/blogPost", {"blog_url": urlVal})
                    .done(function( data ) {
                      console.log('------------------ ', data);
                      console.log('data:-- ', JSON.stringify(data));
                      if(data.code == 200){
                          // alert('Selected Users are sucessfully moved to next round.');
                          // pop('popDiv');
                          alert('Blog Updated sucessfully');
                          window.location = "/users/home";
                      }
                      else{
                          
                          // pop('popDiverror');
                          alert('Technical Error Please try after some time.');
                      }
                    });
        }
      else{
        // pop('popDiverror');
        alert('Not a valid url')
      }

       }

       function validateURL(textval) {
  var urlregex = new RegExp( "^(http|https|ftp)\://([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&amp;%\$\-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(\:[0-9]+)*(/($|[a-zA-Z0-9\.\,\?\'\\\+&amp;%\$#\=~_\-]+))*$");
  return urlregex.test(textval);
}
    </script>
</body>

</html>